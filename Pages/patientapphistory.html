<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../assets/css/appshow.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

</head>

<body>
    <header class="header" id="header">

    </header>

    <body>
        <div class="main">
            <!-- <div class="card">
                <h1>Appointment Confirmation</h1>
                <div class="appointment-details">
                    <p>Name: John Doe</p>
                    <p>Service: Dental Checkup</p>
                    <p>Provider: Dr. Jane Smith</p>
                </div>
                <div class="date-time">
                    <img src="calendar.png" alt="Calendar icon" width="20">
                    <p>Date: May 20, 2023</p>
                    <p>Time: 2:00 PM</p>
                </div>
                <a href="#" class="btn">Add to Calendar</a>
            </div> -->

        </div>




        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>


        <script>

            let urlget = window.location.search
            let parms = new URLSearchParams(urlget)
            let params = parms.get("userid")
            let details = JSON.parse(localStorage.getItem("appointmentdetails"))


            for (let i = 0; i < details.length; i++) {
                if (params == details[i]["user_id"]) {

                    console.log(details[i]["user_id"])
                    console.log(params)
                    let time = details[i]["slotID"];

                    const parts = time.split("_");
                    const times = parts[3].split("-");
                    const timeRange = times[0] + "-" + times[1];


                    const storedDate = details[i].slotdate;

                    const parsedDate = moment(storedDate, 'YYYY-MM-DD');;
                    const year = parsedDate.year();
                    const month = parsedDate.month() + 1;
                    const day = parsedDate.date();

                    let card = document.createElement("div")
                    card.setAttribute("class", "card")
                    card.innerHTML = `<h1>Appointment Booking Details</h1>
                <div class="appointment-details">
                    <p>Doctor Name: ${details[i].docname} </p>
                    <p>Doctor Speciality: ${details[i].docspl} </p>
                </div>
                <div class="date-time">
                    
                    <p><b>Date:</b> ${day}-${month}-${year}</p><br>
                    <p><b>Time:</b> ${timeRange}</p>
                </div>
                <button class="btn" id="${details[i].appid}" onclick = "downloadpdf()">View your appointment</button>`
                    // <a href="#" class="btn">Add to Calendar</a>`

                    document.querySelector(".main").append(card)
                }
            }
            let btnid = document.getElementsByClassName("btn")
            console.log(btnid);
            let idArr = []
            for (let i = 0; i < btnid.length; i++) {
                btnid[i].addEventListener('click', function () {
                    let buttonid = this.id
                    let url = "/Pages/pdf.html?appid=" + buttonid
                    window.location.href = url
                })
            }
            console.log(idArr);



        </script>
        <a href="/Pages/pdf.html"></a>

        <script>
            function docprofile() {
                window.location.href = "./doctorprofile.html"
            }
        </script>

        <script src="../components/header.js">
        </script>
        <script>
            nav_head()
        </script>


    </body>



</html>